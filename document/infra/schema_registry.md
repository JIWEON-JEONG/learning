# Schema Registry

## 배경 
Kafka 스키마의 변화에 따른 문제를 해결하기위해 나오게 되었다. 

1. 데이터 호환성 문제 
- 프로듀서가 스키마를 수정하였을때, 컨슈머가 필드를 인식하지 못해 파싱 오류 발생.
2. 스키마 관리의 어려움
- 스키마를 프로듀서, 컨슈머s 들 모두 분산하여 관리해야하기 때문에 일관성 문제 발생.

## 해결 
스키마의 중앙집중식 관리를 통해 문제를 해결한다. 

1. 카프카에 메시지를 보내기 전에, Producer 는 Schema Registry 에 본인의 스키마를 등록한다. 고유한 ID를 통해 관리.
2. 프로듀서는 실제 메시지 페이로드와 함께 스키마 ID를 함께 보낸다.
3. 스키마 ID 를 통해 컨슈머에서는 스키마를 가지고 와, 해당 스키마를 역직렬화 하여 사용한다. (컨슈머 측에서는 스키마 관리 X)
4. 호환성 옵션을 통해 세부 설정을 한다. 
    - BACKWARD : 필드 변경이나 삭제를 막아, 하위 호환성을 보장한다.
    - FORWARD : 오래된 프로듀서가 새로운 컨슈머의 호환성을 지킬 수 있도록, default 값 전송.